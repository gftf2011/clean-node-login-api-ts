/**
 * Use Cases
 */
import { EmailOptions, EmailService, IWelcomeEmailUseCase, UserDto } from './ports'

/**
 * @author Gabriel Ferrari Tarallo Ferraz <gftf2011@gmail.com>
 * @desc Contains the logic to send an email after user sign up
 */
export class WelcomeEmailUseCase implements IWelcomeEmailUseCase {
  constructor (
    private readonly emailService: EmailService
  ) {}

  async perform (request: UserDto): Promise<void> {
    const mailOptions: EmailOptions = {
      from: 'Gabriel Ferrari Tarallo Ferraz | Acme <noreply@acme.com>',
      to: request.email,
      subject: 'Welcome to Acme!',
      html: `<div style="max-width: 600px; background-color: #f0f0f9;">
        <div style="display: flex; width: 100%; height: 200px; background-color: #2263e0; flex-direction: row; align-items: flex-start; justify-content: center;">
          <svg style="margin-top: 10px;" xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 120 120" fill="none">
            <path d="M60 16L24 32V56C24 78.2 39.36 98.96 60 104C80.64 98.96 96 78.2 96 56V32L60 16Z" fill="#F0F0FF"/>
            <path d="M60.2 18L26 33.2V56C26 77.09 40.592 96.812 60.2 101.6C79.808 96.812 94.4 77.09 94.4 56V33.2L60.2 18Z" fill="#0466C8"/>
            <path d="M60 21.5L28.5 35.5V56.5C28.5 75.925 41.94 94.09 60 98.5C78.06 94.09 91.5 75.925 91.5 56.5V35.5L60 21.5Z" fill="#F0F0FF"/>
            <path d="M72 48H70V44C70 38.48 65.52 34 60 34C54.48 34 50 38.48 50 44V48H48C45.8 48 44 49.8 44 52V72C44 74.2 45.8 76 48 76H72C74.2 76 76 74.2 76 72V52C76 49.8 74.2 48 72 48ZM54 44C54 40.68 56.68 38 60 38C63.32 38 66 40.68 66 44V48H54V44ZM72 72H48V52H72V72ZM60 66C62.2 66 64 64.2 64 62C64 59.8 62.2 58 60 58C57.8 58 56 59.8 56 62C56 64.2 57.8 66 60 66Z" fill="#0466C8"/>
          </svg>
        </div>
        <main style="
          margin-left: auto;
          margin-right: auto;
          margin-top: -80px;
          border-radius: 4px;
          background-color: #F9F9F9;
          max-width: 480px;
          padding-left: 12px;
          padding-right: 12px;
          padding-bottom: 32px;"
        >
          <h1 style="
            font-family: 'Fira Sans Condensed', sans-serif;
            font-size: 48px;
            font-weight: 100;
            margin-top: 20px;
            text-align: center;
            color: #161640;"
          >
            Acme
          </h1>
          <hr style="
            border-top: 1px solid #EDEDF0;
            max-width: 420px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 1px;"
          />
          <h2 style="
            font-family: 'Poppins', sans-serif;
            font-size: 20px;
            font-weight: 400;
            text-align: center;
            margin-top: 36px;
            color: #161640;"
          >
            ðŸ‘‹ Hi, Welcome aboard <strong>${request.name}</strong> !
          </h2>
          <h3 style="
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            margin-top: 8px;
            color: #161640;"
          >
            Congrats for signing up !
          </h3>
          <div style="
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-top: 24px;
            margin-left: auto;
            margin-right: auto;"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100" fill="none">
              <circle cx="48" cy="50" r="48" fill="#F2AB69"/>
              <path d="M38.6678 31.2787C38.4687 31.4778 38.3176 31.7178 38.1914 31.9809L38.1771 31.9667L18.2382 76.8826L18.2578 76.9021C17.888 77.6186 18.5067 79.0763 19.7742 80.3456C21.0417 81.6131 22.4994 82.2318 23.2158 81.862L23.2336 81.8798L68.1495 61.9391L68.1353 61.9231C68.3966 61.7986 68.6366 61.6475 68.8375 61.4449C71.6143 58.6681 67.1113 49.6639 58.7827 41.3335C50.4505 33.0031 41.4464 28.5019 38.6678 31.2787Z" fill="#DD2E44"/>
              <path d="M41.1104 39.2998L18.7395 75.7537L18.2382 76.8826L18.2578 76.9021C17.888 77.6186 18.5067 79.0763 19.7742 80.3456C20.1866 80.758 20.615 81.0709 21.0346 81.3358L48.2213 48.1884L41.1104 39.2998Z" fill="#EA596E"/>
              <path d="M58.9089 41.1948C67.2109 49.5004 71.8205 58.3534 69.2001 60.9702C66.5816 63.5906 57.7285 58.9827 49.4212 50.6808C41.1175 42.3753 36.5096 33.5186 39.1282 30.9001C41.7486 28.2815 50.6016 32.8893 58.9089 41.1948Z" fill="#A0041E"/>
              <path d="M51.0478 42.1601C50.6941 42.4464 50.2319 42.5957 49.743 42.5424C48.1999 42.3752 46.9022 41.8384 45.9938 40.9904C45.032 40.0927 44.5574 38.8874 44.6871 37.6803C44.9147 35.5612 47.0408 33.6164 50.6656 34.0075C52.0754 34.1586 52.7047 33.7053 52.726 33.4884C52.7509 33.2733 52.2336 32.6956 50.8238 32.5427C49.2808 32.3756 47.983 31.8387 47.0728 30.9907C46.1111 30.093 45.6347 28.8877 45.7662 27.6806C45.9973 25.5616 48.1217 23.6167 51.7429 24.0096C52.7704 24.1198 53.3126 23.9083 53.542 23.7714C53.7251 23.6594 53.798 23.5527 53.8051 23.4905C53.8264 23.2754 53.3162 22.6977 51.9029 22.5448C50.9269 22.4381 50.2194 21.5635 50.3279 20.5857C50.4327 19.6098 51.3056 18.904 52.2851 19.0107C55.9063 19.4 57.5703 21.7519 57.341 23.8727C57.1099 25.9953 54.9855 27.9366 51.3607 27.5473C50.3332 27.4353 49.7963 27.6486 49.5652 27.7855C49.3821 27.8957 49.3074 28.0042 49.3003 28.0646C49.2772 28.2815 49.791 28.8575 51.2043 29.0103C54.8255 29.4014 56.4894 31.7516 56.2601 33.8724C56.0308 35.9915 53.9064 37.9363 50.2834 37.5434C49.2559 37.4332 48.7155 37.6465 48.4844 37.7816C48.2995 37.8954 48.2284 38.0021 48.2213 38.0625C48.1981 38.2776 48.7119 38.8554 50.1234 39.0082C51.0976 39.1149 51.8069 39.9913 51.6985 40.9673C51.6487 41.4544 51.4016 41.8757 51.0478 42.1601Z" fill="#AA8DD8"/>
              <path d="M72.5067 58.6005C76.0141 57.6103 78.4336 59.1747 79.0096 61.228C79.5856 63.2795 78.3376 65.8767 74.832 66.8634C73.4631 67.2473 73.0525 67.9015 73.1076 68.1095C73.168 68.3193 73.8631 68.6642 75.2284 68.2784C78.7341 67.2918 81.1535 68.8562 81.7295 70.9077C82.3091 72.9609 81.0575 75.5546 77.5501 76.543C76.183 76.927 75.7706 77.583 75.831 77.791C75.8897 77.999 76.583 78.3439 77.9501 77.9599C78.8923 77.695 79.8771 78.2443 80.142 79.1883C80.4051 80.134 79.8558 81.1153 78.9101 81.382C75.4062 82.3686 72.9849 80.8078 72.4054 78.7528C71.8294 76.7013 73.0791 74.1076 76.5883 73.1192C77.9572 72.7334 78.3678 72.081 78.3074 71.8712C78.2505 71.6632 77.5572 71.3165 76.1919 71.7005C72.6827 72.6889 70.265 71.1281 69.6872 69.0713C69.1095 67.0198 70.3592 64.4261 73.8667 63.4359C75.2319 63.0537 75.6426 62.3959 75.5857 62.1897C75.5253 61.98 74.8337 61.6351 73.4667 62.0191C72.5209 62.2857 71.5414 61.7346 71.2747 60.7907C71.0099 59.8485 71.5609 58.8672 72.5067 58.6005Z" fill="#77B255"/>
              <path d="M58.8894 53.806C58.3667 53.806 57.8512 53.5767 57.4992 53.1393C56.8859 52.3714 57.0121 51.2532 57.7765 50.6399C58.1641 50.3288 67.4082 43.0686 80.4727 44.9369C81.4451 45.0756 82.1206 45.9751 81.982 46.9475C81.8433 47.9182 80.9509 48.6008 79.9696 48.4551C68.4268 46.816 60.0822 53.3509 60.0004 53.4167C59.6698 53.6798 59.2787 53.806 58.8894 53.806Z" fill="#AA8DD8"/>
              <path d="M28.229 46.4107C28.0601 46.4107 27.8877 46.3858 27.717 46.336C26.7766 46.0534 26.2433 45.0632 26.526 44.1227C28.5401 37.4154 30.3658 26.7117 28.1223 23.9207C27.8717 23.6043 27.493 23.2932 26.6255 23.359C24.958 23.487 25.1162 27.0051 25.118 27.0406C25.1927 28.0202 24.4567 28.8735 23.4789 28.9463C22.4852 29.0068 21.6461 28.285 21.5732 27.3055C21.3901 24.854 22.1528 20.1324 26.3588 19.8142C28.2361 19.672 29.7952 20.3244 30.8956 21.6932C35.1106 26.9393 30.8316 42.1477 29.9321 45.1449C29.701 45.9147 28.9934 46.4107 28.229 46.4107Z" fill="#77B255"/>
              <path d="M63.3319 37.5221C64.8046 37.5221 65.9985 36.3282 65.9985 34.8555C65.9985 33.3828 64.8046 32.1889 63.3319 32.1889C61.8592 32.1889 60.6653 33.3828 60.6653 34.8555C60.6653 36.3282 61.8592 37.5221 63.3319 37.5221Z" fill="#5C913B"/>
              <path d="M21.5554 53.5216C23.5191 53.5216 25.1109 51.9297 25.1109 49.9661C25.1109 48.0025 23.5191 46.4107 21.5554 46.4107C19.5918 46.4107 18 48.0025 18 49.9661C18 51.9297 19.5918 53.5216 21.5554 53.5216Z" fill="#9266CC"/>
              <path d="M75.7759 55.2993C77.2486 55.2993 78.4425 54.1054 78.4425 52.6327C78.4425 51.16 77.2486 49.9661 75.7759 49.9661C74.3032 49.9661 73.1093 51.16 73.1093 52.6327C73.1093 54.1054 74.3032 55.2993 75.7759 55.2993Z" fill="#5C913B"/>
              <path d="M59.7764 76.6319C61.2492 76.6319 62.443 75.4381 62.443 73.9653C62.443 72.4926 61.2492 71.2988 59.7764 71.2988C58.3037 71.2988 57.1099 72.4926 57.1099 73.9653C57.1099 75.4381 58.3037 76.6319 59.7764 76.6319Z" fill="#5C913B"/>
              <path d="M67.7762 28.6335C69.7398 28.6335 71.3316 27.0416 71.3316 25.078C71.3316 23.1144 69.7398 21.5226 67.7762 21.5226C65.8126 21.5226 64.2207 23.1144 64.2207 25.078C64.2207 27.0416 65.8126 28.6335 67.7762 28.6335Z" fill="#FFCC4D"/>
              <path d="M75.7759 35.7444C77.2486 35.7444 78.4425 34.5505 78.4425 33.0778C78.4425 31.6051 77.2486 30.4112 75.7759 30.4112C74.3032 30.4112 73.1093 31.6051 73.1093 33.0778C73.1093 34.5505 74.3032 35.7444 75.7759 35.7444Z" fill="#FFCC4D"/>
              <path d="M70.4428 42.8552C71.9155 42.8552 73.1093 41.6614 73.1093 40.1887C73.1093 38.7159 71.9155 37.5221 70.4428 37.5221C68.9701 37.5221 67.7762 38.7159 67.7762 40.1887C67.7762 41.6614 68.9701 42.8552 70.4428 42.8552Z" fill="#FFCC4D"/>
              <path d="M31.3329 62.4102C32.8056 62.4102 33.9995 61.2163 33.9995 59.7436C33.9995 58.2709 32.8056 57.077 31.3329 57.077C29.8602 57.077 28.6663 58.2709 28.6663 59.7436C28.6663 61.2163 29.8602 62.4102 31.3329 62.4102Z" fill="#FFCC4D"/>
            </svg>
          </div>
          <p style="
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-align: center;
            margin-top: 24px;
            color: #161640;"
          >
            Thank you for using our services, our team will guide you if you have any doubts ralated to services, or platform usage !
          </p>
          <hr style="
            border-top: 2px solid #2263e0;
            max-width: 32px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 16px;"
          />
          <p style="
            font-family: 'Poppins', sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-align: center;
            margin-top: 16px;
            color: #161640;"
          >
            This a welcome message email !
            <br />
            Please do not reply it ðŸ˜Ž !
          </p>
          <hr style="
            border-top: 1px solid #EDEDF0;
            max-width: 420px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 32px;
            margin-bottom: 80px;"
          />
        </main>
      </div>`
    }
    const response = await this.emailService.send(mailOptions)
    console.log(response)
  }
}
